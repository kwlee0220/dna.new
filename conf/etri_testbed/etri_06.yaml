id: etri:06

camera:
  # uri: data/2022/crops/etri_06_crop.mp4
  # uri: data/2021/etri_06.mp4
  # uri: data/etri_06_hot.mp4
  uri: data/2022/etri_061.mp4
  sync: False
  # begin_frame: 12015
  # open_ts: 590
  open_ts: 0

tracker:
  draw: ['tracks', 'track_zones']
  n_init: 5
  track_zones:
    - [[205, 607], [792, 442], [941, 332], [1099, 332], [1297, 496], [1826, 607], [1829, 1001], [6, 853], [4, 606]]
  magnifying_zones:
    - [700, 320, 1300, 690]
  exit_zones:
      - [1017, 275, 1111, 334]   # 정문 방향
      - [1600, 686, 1920, 1080]  # 12동 방향
      - [3, 600, 120, 900]        # 7동 방향

sql_connection: &postgresql_connection
  host: localhost
  port: 5432
  dbname: dna
  user: dna
  password: urc2004

local_kafka_connection: &local_kafka_connection
  bootstrap_servers: [localhost:9092]
dna_kafka_connection: &dna_kafka_connection
  bootstrap_servers: [kafka01:9092, kafka02:9092, kafka03:9092]

publishing:
  # tick_interval: 1.0
  refine_tracks:
    buffer_size: 10
    buffer_timeout: 1.5
  # min_path_length: 10
  attach_world_coordinates:
    camera_geometry: regions/etri_testbed/etri_testbed.json
    camera_index: 2
#   stabilization:
#     look_ahead: 7
#     # smoothing_factor: 1
  zone_pipeline:
    zones:
      A: [[1409, 516], [955, 721], [974, 1037], [1836, 1033], [1827, 606], [1409, 516]]
      B: [[519, 521], [700, 714], [696, 1047], [20, 1051], [18, 562], [519, 521]]
      C: [[651, 529], [1352, 526], [1122, 353], [896, 354], [651, 529]]
    motions:
      'AB': 'AB'
      'AC': 'AC'
      'BA': 'BA'
      'BC': 'BC'
      'CA': 'CA'
      'CB': 'CB'

  plugins:
    publish_tracks:
      <<: *local_kafka_connection
      topic: 'track-events'
    publish_motions:
      <<: *local_kafka_connection
      topic: 'track-motions'
    publish_features:
      distinct_distance: 0.2
      min_crop_size: 80x50
      <<: *local_kafka_connection
      topic: 'track-features'